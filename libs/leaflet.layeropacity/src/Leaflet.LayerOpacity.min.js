L.LeafletLayerOpacity=L.Control.extend({options:{position:"topright",title:"Layers opacity",collapse:!0,layers:{},layerOnMap:!0,step:1},initialize:function(t){L.Util.setOptions(this,t)},onAdd:function(t){return this._initLayout(),this._container},onRemove:function(t){},_initLayout:function(){if(this._container=L.DomUtil.create("div","leaflet-bar leaflet-layer-opacity"),L.DomEvent.disableClickPropagation(this._container),L.DomEvent.disableScrollPropagation(this._container),this._toggle=L.DomUtil.create("a","leaflet-layer-opacity-toggle leaflet-layer-opacity-toggleimg"),this._content=L.DomUtil.create("div","leaflet-layer-opacity-content"),this._container.appendChild(this._content),this._container.appendChild(this._toggle),this.options.title){const t=L.DomUtil.create("div","leaflet-layer-opacity-title");t.innerHTML=this.options.title,this._content.appendChild(t)}this.options.collapse?(this._collapse(),L.DomEvent.on(this._container,{mouseenter:this._expand,mouseleave:this._collapse},this)):this._expand(),this._layerscontainer=L.DomUtil.create("div","leaflet-layer-opacity-sliders"),this._content.appendChild(this._layerscontainer),this.options.layerOnMap&&(this._map.on("layeradd",(t=>{this._update()})),this._map.on("layerremove",(t=>{this._update()}))),this._update()},_update:function(){if(this.options.layers){let t=L.DomUtil.create("div");this.options.layers instanceof Array?this.options.layers.forEach((e=>{let i=e.options.attribution,n=null;this.options.layerOnMap?this._map.hasLayer(e)&&(n=this._getSlider(e,i),t.appendChild(n)):(n=this._getSlider(e,i),t.appendChild(n))})):"object"==typeof this.options.layers&&Object.keys(this.options.layers).forEach((e=>{let i=this.options.layers[e],n=null;this.options.layerOnMap?this._map.hasLayer(i)&&(n=this._getSlider(i,e),t.appendChild(n)):(n=this._getSlider(i,e),t.appendChild(n))})),this._layerscontainer.replaceChildren(t)}if(!this._container)return this},_getSlider:function(t,e){let i=null;if(t.options.opacity)i=(100*t.options.opacity).toFixed(0);else if("function"==typeof t.options.style)i=(100*t.options.style().opacity).toFixed(0);else if("function"==typeof t.getLayers){let e=t.getLayers();i=e.lenght>0?(100*e[0].options.opacity).toFixed(0):100}let n=L.DomUtil.create("div"),a=L.DomUtil.create("div","leaflet-layer-opacity-label");a.innerHTML=e,n.appendChild(a);let o=L.DomUtil.create("div","leaflet-layer-opacity-slider-container"),l=L.DomUtil.create("input","leaflet-layer-opacity-slider");l.setAttribute("type","range"),l.setAttribute("min","0"),l.setAttribute("max","100"),l.setAttribute("step",this.options.step),l.setAttribute("value",i),o.appendChild(l);let s=L.DomUtil.create("output");return s.innerText=`${i}%`,o.appendChild(s),n.appendChild(o),l.oninput=e=>{let i=e.target.value;s.innerText=`${i}%`;let n=i/100;"function"==typeof t.setOpacity?t.setOpacity(n):"function"==typeof t.setStyle&&t.setStyle({opacity:n})},n},_expand:function(){return this._content.style.display=null,this._toggle.style.display="none",this},_collapse:function(){return this._content.style.display="none",this._toggle.style.display=null,this}}),L.leafletLayerOpacity=function(t){return new L.LeafletLayerOpacity(t)};